<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="Precog Checkers - Play against Agatha, an AI that sees your moves before you make them">
  <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><circle cx='50' cy='50' r='45' fill='%230a1628' stroke='%2300d4ff' stroke-width='4'/><circle cx='50' cy='50' r='25' fill='%2300d4ff' opacity='0.3'/></svg>">
  <title>Precog Checkers</title>
  <link rel="stylesheet" href="styles/main.css">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700;900&family=Rajdhani:wght@300;400;500;600;700&display=swap" rel="stylesheet">
</head>
<body>
  <div class="app-container">
    <!-- Header -->
    <header class="header">
      <h1 class="header__title">
        <span class="header__icon">&#9823;</span>
        PRECOG CHECKERS
      </h1>
      <div class="header__controls">
        <button id="settings-btn" class="btn btn--icon" aria-label="Settings" title="Settings">
          <span class="settings-icon">&#9881;</span>
        </button>
        <button id="sound-toggle" class="btn btn--icon" aria-label="Toggle sound" title="Toggle sound">
          <span class="sound-icon sound-icon--off">&#128264;</span>
        </button>
        <button id="new-game-btn" class="btn btn--primary">New Game</button>
      </div>
    </header>

    <!-- Main Content -->
    <main class="main-content">
      <!-- Game Board Section -->
      <section class="board-section">
        <canvas id="game-canvas" class="game-canvas"></canvas>
      </section>

      <!-- Side Panel -->
      <aside class="side-panel">
        <!-- Score Display -->
        <div class="score-panel">
          <div class="score-row score-row--agatha">
            <span class="score-label">AGATHA</span>
            <div class="piece-count" id="agatha-pieces">
              <span class="piece-dots"></span>
              <span class="piece-number">12</span>
            </div>
          </div>
          <div class="score-row score-row--human">
            <span class="score-label">YOU</span>
            <div class="piece-count" id="human-pieces">
              <span class="piece-dots"></span>
              <span class="piece-number">12</span>
            </div>
          </div>
        </div>

        <!-- Agatha's Thoughts -->
        <div class="thoughts-panel">
          <h2 class="thoughts-panel__title">AGATHA'S VISION</h2>
          <div class="thoughts-panel__content" id="agatha-thoughts">
            <p class="thoughts-panel__text">I see all possible futures... Make your move, human.</p>
          </div>
        </div>

        <!-- Human Response -->
        <div class="response-panel">
          <h2 class="response-panel__title">YOUR RESPONSE</h2>
          <div class="response-panel__content">
            <textarea 
              id="human-response" 
              class="response-panel__input" 
              placeholder="Talk back to Agatha..."
              rows="2"
            ></textarea>
            <button id="send-response" class="btn btn--primary btn--small">Send</button>
          </div>
        </div>

        <!-- Move History -->
        <div class="history-panel">
          <h2 class="history-panel__title">MOVE HISTORY</h2>
          <div class="history-panel__list" id="move-history">
            <!-- Move entries will be added here dynamically -->
          </div>
        </div>
      </aside>
    </main>

    <!-- Status Bar -->
    <footer class="status-bar">
      <p class="status-bar__message" id="status-message">Your turn</p>
    </footer>

    <!-- Game Over Modal -->
    <div class="modal" id="game-over-modal" hidden>
      <div class="modal__backdrop"></div>
      <div class="modal__content">
        <h2 class="modal__title" id="modal-title">Game Over</h2>
        <p class="modal__message" id="modal-message"></p>
        <button class="btn btn--primary btn--large" id="modal-new-game">Play Again</button>
      </div>
    </div>

    <!-- Settings Modal -->
    <div class="modal" id="settings-modal" hidden>
      <div class="modal__backdrop" id="settings-backdrop"></div>
      <div class="modal__content modal__content--settings">
        <h2 class="modal__title">Settings</h2>
        
        <div class="settings-section">
          <h3 class="settings-section__title">Anthropic API Key</h3>
          <p class="settings-section__desc">
            Optional: Enter your own API key to enable AI-powered commentary from Agatha. 
            Without a key, Agatha uses pre-written responses.
          </p>
          <div class="settings-section__warning">
            <strong>Security Note:</strong> Your key is stored only in this browser tab's memory 
            (sessionStorage) and is cleared when you close the tab. It is sent directly to 
            Anthropic's API from your browser. Never share API keys publicly.
          </div>
          <form class="settings-section__input-group" autocomplete="off" onsubmit="return false;">
            <input 
              type="password" 
              id="api-key-input" 
              class="settings-section__input" 
              placeholder="sk-ant-..."
              autocomplete="off"
            />
            <button type="button" id="toggle-key-visibility" class="btn btn--icon btn--small" title="Show/hide key">
              <span class="eye-icon">&#128065;</span>
            </button>
          </form>
          <div class="settings-section__status" id="api-key-status">
            No API key configured - using fallback responses
          </div>
        </div>

        <div class="modal__buttons">
          <button class="btn" id="clear-key-btn">Clear Key</button>
          <button class="btn btn--primary" id="save-settings-btn">Save & Close</button>
        </div>
      </div>
    </div>
  </div>

  <script type="module" src="dist/main.js"></script>
</body>
</html>
